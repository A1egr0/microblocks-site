<html>
    <head>
        <meta charset="UTF-8">
        <title>MicroBlocks: Small, Fast, Human Friendly</title>
        <meta name="description" content="MicroBlocks is a dynamic, blocks-based language that runs right inside microcontrollers">
        <meta name="author" content="Bernat Romagosa">
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
        <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
        <link rel="stylesheet" href="reset.css">
        <link rel="stylesheet" href="style.css">
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-118134778-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-118134778-1');
        </script>
    </head>
    <body>
        <img class="ribbon" src="pre-alpha-ribbon.png"/>
        <div id="flowers"></div>
        <header>
            <a href="#" class="logo"><img src="logo.png"/></a>
            <nav class="menu">
                <a href="#intro">Introduction</a>
                <a href="#examples">Examples</a>
                <a href="#download">Download</a>
                <a href="#usage">Usage</a>
                <a href="#source">Source</a>
                <a href="#devices">Supported Devices</a>
                <a href="#techspecs">Technical Details</a>
                <a href="#credits">Credits</a>
                <a href="#collaboration">Collaboration</a>
                <a href="#contact">Contact</a>
            </nav>
        </header>
        <img id="flying-bugs" src="flying-bugs.png"/>
        <div id="wrapper">
<h1 id="intro">Introduction</h1>
<p><span>
    MicroBlocks is a new programming language inspired by <a href="https://scratch.mit.edu" target="_blank">Scratch</a> that runs right inside microcontroller boards such as the <a href="https://microbit.org" target="_blank">micro:bit</a>, the <a href="http://www.nodemcu.com/index_en.html" target="_blank">NodeMCU</a> and many <a href="https://arduino.cc" target="_blank">Arduino</a> boards.
</span></p>
<p><span>
    The MicroBlocks system allows for dynamic, parallel and interactive programming, just like in Scratch, but with the twist of letting your projects run autonomously inside the board without being tethered to a computer. Thus, MicroBlocks provides the immediacy and liveness of tethered blocks programming, while supporting real-world applications that require precision timing, autonomous operation, or physically embedding the processor into projects. For example, one might write a program to record acceleration data, then embed the microcontroller and a small battery in a model rocket to explore G-forces at launch time.
</span></p>
<p><span>
    In other words, MicroBlocks lets you program your boards exactly like you would in <a href="http://snap4arduino.rocks" target="_blank">Snap4Arduino</a>, <a href="http://s4a.cat" target="_blank">S4A</a> or the <a href="https://khanning.github.io/scratch-arduino-extension/" target="_blank">Arduino extension</a> for Scratch, and when you are happy with your program you can just unplug the board from your computer and everything will keep running as if by magic!
</span></p>
<p><span>
    With MicroBlocks, you can build your own "real world" digital instruments, interactive jewelry, electronic games and measuring devices, all by using blocks.
</span></p>
<h1 id="examples">Examples</h1>
<p><span></span></p>
<ul class="flex videos">
    <li>
        <div class="youtube" data-embed="CqfFjn_kMc4"><div class="play-button"></div></div>
        <h6>An electronic die</h6>
    </li>
    <li>
        <div class="youtube" data-embed="gPKXRC7CYu8"><div class="play-button"></div></div>
        <h6>A square wave synthesizer</h6>
    </li>
    <li>
        <div class="youtube" data-embed="fstO8b7i4pw"><div class="play-button"></div></div>
        <h6>An animation with speed control</h6>
    </li>
    <li>
        <div class="youtube" data-embed="9mPrWXqf5nE"><div class="play-button"></div></div>
        <h6>A bubble level</h6>
    </li>
    <li>
        <div class="youtube" data-embed="GiGiRHgWnKM"><div class="play-button"></div></div>
        <h6>A rock-paper-scissors game</h6>
    </li>
    <li>
        <div class="youtube" data-embed="xDQgpxCZkn4"><div class="play-button"></div></div>
        <h6>A digital music box</h6>
    </li>
</ul>
<script>
var videos = document.querySelectorAll('.youtube');
for (var i = 0; i < videos.length; i++) { 
    var thumb = 'https://img.youtube.com/vi/'+ videos[i].dataset.embed +'/sddefault.jpg',
        image = new Image();

    image.src = thumb;
    image.addEventListener('load', function() { videos[i].appendChild(image); }(i));

    videos[i].addEventListener('click', function() {
        var iframe = document.createElement('iframe');
        iframe.setAttribute('frameborder', '0');
        iframe.setAttribute('allowfullscreen', '');
        iframe.setAttribute('src', 'https://www.youtube.com/embed/'+ this.dataset.embed +'?rel=0&showinfo=0&autoplay=1');
        this.innerHTML = '';
        this.appendChild(iframe);
    });
}
</script>
<h1 id="download">Download</h1>
<p><span><a href="http://gpblocks.org/mb/MicroBlocks.zip" target="_blank">Download</a> the preliminary standalone microBlocks IDE. This package includes binaries for MacOSX, GNU/Linux and MS Windows. (Older versions are <a href="http://gpblocks.org/mb" target="_blank">here</a>.)</span></p>

<p><span>MicroBlocks is still pre-alpha software, so stay alert for bugs and come back often to check for new versions.</span></p>
<p><span>There is a Snap<em>!</em> IDE also in the works, but it is not yet public. Stay tuned.</span></p>
<h1 id="usage">Usage</h1>
<h2>Preparing your System</h2>
<h3>Windows</h3>
<p><span>If you are running a version of Windows earlier than Windows 10, you may need to install USB-serial drivers for your board. In the case of the micro:bit, you can follow these instructions:</span></p>
<p><span><a href="https://support.microbit.org/support/solutions/articles/19000022103-how-do-i-use-the-serial-port-with-a-micro-bit-on-windows" target="_blank">https://support.microbit.org/support/solutions/articles/19000022103-how-do-i-use-the-serial-port-with-a-micro-bit-on-windows</a></span></p>
<p><span>Be sure to plug in the board before you run the driver installer.</span></p>
<p><span>With the board plugged in, you can check the COM ports in the device manager to find out which COM port is it connected to. We've seen COM3, COM5, and COM6 on various laptops.</span></p>
<h3>GNU/Linux</h3>
<p><span>On many Linux systems, users don’t have access to the USB serial port by default, so you will get an error when you try to open it. One quick solution to that is to launch MicroBlocks from the command line using “sudo”:</span></p>
<pre>sudo ./ublocks-linux64bit</pre>
<p><span>A more convenient long term solution is to add yourself to the group that owns the serial port as follows.</span></p>
<p><span>First, with the board attached, display the serial port entry with the command:</span></p>
<pre>ls -l /dev/tty[AU]*</pre>
<p><span>You'll see a line such as:</span></p>
<pre>crw-rw---- 1 root dialout 166, 0 Jan 25 07:23 /dev/ttyACM0</pre>
<p><span>The serial port’s group is the word after “root”, in this case “dialout”. Add yourself to that group:</span></p>
<pre>sudo usermod -G dialout -a [YOUR_USER_NAME]</pre>
<p><span>then log out and back in to make the change take effect.</span></p>
<p><span>Once this is done, you can start MicroBlocks simply by double-clicking on the Linux executable. Note that it still can be useful to run MicroBlocks from the terminal when debugging, since the “print” block logs messages to the terminal window.</span></p>
<h2>VM Installation</h2>
<p><span>If you have a BBC micro:bit, Calliope mini, or an AdaFruit board such as the Circuit Playground Express that supports loading binary files by drag-and-drop, you can just drop the appropriate .hex or .uf2 file onto the virtual disk for your board to install it.</span></p>
<p><span>If you have an ARM-based Arduino or any other board with Arduino IDE support, or if you just want to build the virtual machine yourself, read on.</span></p>
<p><span>The MicroBlocks virtual machine is written in C and C++. The Arduino platform is preferred, but it has also been built using the mbed platform (not supported). It can also be built for Linux-based environments such as the Raspberry Pi, and it should be portable to other platforms that have a C compiler with minimal effort.</span></p>
<p><span>The MicroBlocks virtual machine can be compiled and loaded onto a board using the Arduino IDE (version 1.8 or later) with the appropriate board installed and selected. Open the file "vm.ino", select your board from the board manager, and click the upload button.</span></p>
<h2>Connecting to the Board</h2>
<h3>MicroBlocks standalone IDE</h3>
<p><span>Start MicroBlocks by double-clicking the executable for your platform
(e.g. ublocks-win.exe), then click on the "Connect" button on top of the app and select the USB serial port from the menu:</span></p>
<p><img src="connect.png"></p>
<p><span>Port names differ for each platform. In GNU/Linux your port names will start with "ttyACM" or "ttyUSB", in MacOSX they start with "cu.usbmodem" or "tty.usbmodem", and in Windows they start with "COM". In Windows, the correct port is usually the last one.</span></p>
<p><span>If you don't get an error, you should be connected to the board, and the indicator will change from red to green:</span></p>
<p><img src="connected.png"></p>
<p><span>To ensure everything is working, right click on the green indicator and select "virtual machine version":</span></p>
<p><img src="vmversion.png"></p>
<p><span>A small dialog should pop up showing the version of the virtual machine installed in your board.</span></p>
<h1 id="source">Source</h1>
<p><span>You can find the source code for the MicroBlocks VM, MicroBlocks standalone IDE and Websockets to serial connector in our <a href="https://bitbucket.org/john_maloney/smallvm">BitBucket repository</a>.</span></p>
<p><span>The Snap<em>!</em> version of the MicroBlocks IDE can be found in this other <a href="https://bitbucket.org/bromagosa/snap-ublocks/">BitBucket repository</a></span>.</p>
<h1 id="devices">Supported Devices</h1>
<h2>Technical Requirements</h2>
<p><span>The MicroBlocks virtual machine is designed for 32 bit microcontrollers. It requires at least 8Kb of RAM and 40Kb of flash memory. For most supported boards, the virtual machine is built using the Arduino IDE and libraries, but it has been ported to vanilla Linux. In the past, it was also built using the mbed libraries, although that option is no longer maintained.</span></p>
<h2>MicroBlocks Capable Boards</h2>
<p><span>The following boards are officially supported by the MicroBlocks system:</span></p>
<ul class="list">
    <li><a href="http://microbit.org">Micro:Bit</a></li>
    <li><a href="https://www.calliope.cc">Calliope</a></li>
    <li><a href="https://learn.adafruit.com/adafruit-circuit-playground-express">Circuit Playground Express</a></li>
    <li><a href="https://store.arduino.cc/arduino-due">Arduino Due</a></li>
    <li><a href="https://store.arduino.cc/arduino-mkrzero">Arduino MKR Zero</a></li>
    <li><a href="https://store.arduino.cc/genuino-zero">Arduino Zero</a></li>
</ul>
<p><span>The following boards are supported by the MicroBlocks system but present some limitations or problems:</span></p>
<ul class="list">
    <li><a href="http://www.nodemcu.com/index_en.html">NodeMCU</a> <span class="issue">no persistence yet</span></li>
    <li><a href="https://www.raspberrypi.org/products/raspberry-pi-zero/">Raspberry Pi Zero W</a> <span class="issue">no persistence yet</span></li>
    <li><a href="https://store.arduino.cc/arduino-primo">Arduino Primo</a> <span class="issue">retired by Arduino</span></li>
    <li><a href="https://store.arduino.cc/arduino-m0">Arduino M0</a> <span class="issue">retired by Arduino</span></li>
</ul>
<p><span>For the latest list of supported boards their status, see <a href="https://bitbucket.org/john_maloney/smallvm/wiki/Devices">Device List</a> on our WIki.
<h1 id="techspecs">Technical Details</h1>
<h2>The MicroBlocks Virtual Machine</h2>
<h3>Instructions</h3>
<p><span>MicroBlocks code is executed by a simple interpreter or <em>virtual machine</em> (VM) running on the microcontroller board. The instructions for this virtual machine are 32-bits consisting of an 8-bit operation (opcode) and a 24-bit operand:</p></span>

<pre>
&lt;operand (24 bits)&gt;&lt;opcode (8-bits)&gt;
</pre>

<p><span>The opcode tells the virtual machine what to do. The operand is used to in different ways by different opcodes. For example, it can be used to encode constant values or jump offsets. Some opcodes don't use the operand at all, but both the interpreter and the compiler are simplified by using the same instruction format for all opcodes.</p></span>

<p><span>The interpreter is a stack machine. To execute a given opcode, its arguments (i.e. the values of any parameters) are first pushed onto the stack, then the code for the opcode is run. That code pops any arguments off the stack and, optionally, pushes a return value onto the stack.</p></span>

<p><span>For example, the instructions for <em>"set user LED &lt;true&gt;"</em> are:</p></span>

<pre>
pushImmediate true		// push the boolean value 'true'
setLEDOp			// pop 'true' off the stack and set the state of the user LED to it
</pre>

<p><span>The instructions for <em>"set user LED (tilt-x &lt; 10)"</em>  are:</p></span>

<pre>
mbTiltX				// pushes the value of the tilt X sensor
pushImmediate 10		// pushes the number 10
greaterThan			// remove the two arguments and pushes true if tilt-x is less than 10
setLEDOp			// pop a boolean value and and set the state of the user LED to it
</pre>

<h3>Tasks</h3>

<p><span>MicroBlocks appears to run many scripts at the same time, but that is an illusion. The virtual machine actually runs a few instructions of one script, then a few instructions of the next script, and so on. It only executes one script at a time, but switches between those scripts (or "tasks") so quickly that they appear to be running simultaneously.</p></span>

<p><span>Unlike many programming languages, MicroBlocks can only switch to the next task at certain well-defined points in the code: at the end of a loop or at an instruction that explicitly waits, such as "wait 10 milliseconds". This avoids many of the concurrency issues (or <em>race conditions</em>) that one encounters in other languages. It also means advanced users can implement their own higher-level concurrency mechanisms (e.g. locks, semaphores, or monitors) in MicroBlocks because a test followed by some action such as setting a flag cannot be interrupted by another MicroBlocks task partway through. (Such uninterruptible sequences are sometimes called <em>critical sections</em>. In MicroBlocks, every command sequence that does not contain a loop or a block that explicitly waits is an implicit critical section.)</p></span>

<p><span>Between running user scripts, the MicroBlocks virtual machine handles a few system chores. For example, it checks for incoming commands from the programming environment when the board is tethered. On some devices, it may also perform additional system tasks. For example, on the BBC micro:bit the virtual machine periodically updates the 5x5 LED display.</p></span>

<h3>Protocol</h3>

<p><span>The MicroBlocks VM communicates with IDEs and other types of software (such as the Mozilla Web of Things gateway) by means of a home brewed serial protocol.</span></p>

<p><span>You can find specifications for this protocol <a href="https://bitbucket.org/john_maloney/smallvm/src/master/SERIAL_PROTOCOL.md">here</a>.</span></p>

<h2>The MicroBlocks Programming Environment (IDE)</h2>

<p><span>There are currently two blocks-based programming environments for MicroBlocks, a stand-alone system based on <a href="https://gpblocks.org" target="_blank">GP</a> and one integrated into <a href="https://snap.berkeley.edu" target="_blank">Snap<em>!</em></a> that allows the MicroBlocks programs and Snap<em>!</em> programs to interact with each other when the board is tethered.
In the future, there could be other MicroBlocks programming environments, perhaps some using textual code representations rather than blocks.
</span></p>

<p><span>
The programming environment includes a <em>compiler</em> that translates user scripts into a sequence of MicroBlocks opcodes and a code manager that downloads scripts to the board, starts and stops scripts, and keeps track of the running status of every script so it can display graphical feedback (e.g. a glowing border around scripts that are running). Both environments can display the instructions generated by the compiler, allowing users to see how their scripts get turned into low level <em>machine code</em> for the virtual machine.
</span></p>

<!--
<h2>The MicroBlocks connector</h2>
<p><span></span></p>
<h2>The Snap<em>!</em> IDE</h2>
<p><span></span></p>
--!>
<h1 id="credits">Credits</h1>
<p><span>MicroBlocks is a project by <a href="https://harc.ycr.org/member/john_maloney/" target="_blank">John Maloney</a>, <a href="https://github.com/jmoenig" target="_blank">Jens Mönig</a> and <a href="http://romagosa.work" target="_blank">Bernat Romagosa</a>.</span></p>
<p><span>The MicroBlocks bunny logo was designed by <a href="http://hrum-design.ru" target="_blank">Constantine Rotkevich</a>.</span></p>
<h1 id="collaboration">Collaboration</h1>
<p><span>MicroBlocks is currently collaborating with the following organizations, projects and companies:</span></p>
<ul class="flex">
    <li><a href="http://gpblocks.org" target="_blank"><img class="logo" src="GPLogo260.png"/></a></li>
    <li><a href="https://snap.berkeley.edu" target="_blank"><img class="logo" src="snap-logo.png"/></a></li>
    <li><a href="https://www.birdbraintechnologies.com" target="_blank"><img class="logo" src="birdbrain-logo.png"/></a></li>
    <li><a href="https://www.mozilla.org" target="_blank"><img class="logo" src="mozilla-logo.png"/></a></li>
</ul>
<p><span></span></p>
<p><span>We are actively looking for long term or short term funding. If you would like to make a donation or sponsor this project, please get in touch with us at <a href="mailto:interest@microblocks.fun">interest@microblocks.fun</a>.</span></p>
<h1 id="contact">Contact</h1>
<span><p>For bug reports or feature requests, please use our <a href="https://bitbucket.org/john_maloney/smallvm/issues">issue tracker at BitBucket</a>.</p></span>
<span><p>For anything else, you can reach us at <a href="mailto:interest@microblocks.fun">interest@microblocks.fun</a>.</p></span>
        </div>
        <footer>
            <a href="#"><i class="bunny"></i></a>
            <small>&copy; 2018 by <a href="https://harc.ycr.org/member/john_maloney/" target="_blank">John Maloney</a>, <a href="https://github.com/jmoenig" target="_blank">Jens Mönig</a> and <a href="http://romagosa.work" target="_blank">Bernat Romagosa</a>. MicroBlocks is free software, released under the <a href="https://www.mozilla.org/en-US/MPL/2.0/" target="_blank">Mozilla Public License v2.0</a>.</small>
            <img class="grass" src="grass.png"/>
        </footer>
        <script>
            var div = document.querySelector('#flowers'),
                index = 0,
                flowers = [];
            for (var i = 0; i < 100; i++) {
                var flower = document.createElement('img');
                flower.src = 'flower.png';
                flower.className = 'flower';
                flower.rotation = Math.random() * 90;
                flower.scale = Math.random();
                flower.style.transform = 'rotate(' + flower.rotation + 'deg) scale(' + flower.scale + ')';
                flower.style.left = Math.random() * document.body.scrollWidth;
                flower.style.top = Math.random() * document.body.scrollHeight * 1.2;
                div.append(flower);
                flowers.push(flower)
            }
            document.onscroll = function () {
                requestAnimationFrame(function () {
                    flowers.forEach(function (flower) {
                        flower.style.transform = 'rotate(' + flower.rotation * document.body.scrollTop * 0.05 + 'deg) scale(' + flower.scale + ')';
                    });
                    div.style.top = document.body.scrollTop * -1.2 + 'px';
                    index += 10;
                });
            };
        </script>
    </body>
<html>
